import{Ab as Ve,Bb as $e,Ca as ce,Cb as je,D as s,Da as S,Db as Le,Ea as fe,Eb as Qe,F as p,Fa as he,G as r,Gb as z,H as i,Ha as xe,Hb as W,I as f,Ia as ye,Ib as ze,J as h,K as x,Ka as _e,L as H,La as ve,Lb as We,M as N,Ma as ge,Mb as Ue,N as E,Na as Ce,Oa as be,Ob as U,P as T,Pa as Se,Q as D,Qa as Ee,R as M,Ra as we,Rb as Je,S as n,Sa as Fe,T as c,Ta as Ge,Ua as Ie,Va as Oe,W as de,Wa as Ne,X as y,Y as C,Z as b,_a as Te,a as ee,ab as De,bb as L,ca as pe,cb as Me,da as B,db as qe,e as te,ea as V,eb as Re,f as ie,fa as se,g as re,ga as $,h as ne,j as oe,k as ae,n as k,ob as Q,q as P,r as A,ra as ue,s as I,t as O,ta as j,u as le,vb as ke,wb as Pe,x as me,xa as J,xb as Ae,y as a,yb as He,z as _,zb as Be}from"./chunk-4H4KE4SV.js";var rt=["statusField"];function nt(e,t){if(e&1&&(r(0,"li"),n(1),i()),e&2){let d=t.$implicit;a(),c(d)}}function ot(e,t){if(e&1&&(r(0,"div",37),s(1,nt,2,1,"li",16),i()),e&2){let d=E();a(),p("ngForOf",d.errors)}}function at(e,t){e&1&&(r(0,"my-error"),n(1," Veuillez remplir ce champ. "),i())}function lt(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function mt(e,t){if(e&1&&(h(0),r(1,"option",38),n(2),i(),x()),e&2){let d=t.$implicit;a(),p("value",d.code),a(),c(d.name)}}function dt(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function pt(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function st(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function ut(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function ct(e,t){if(e&1&&(r(0,"div",39),f(1,"div",28),r(2,"div",24),f(3,"input",40)(4,"input",41)(5,"input",42)(6,"input",43)(7,"input",44),r(8,"div",45)(9,"h3",46),n(10),i(),r(11,"div",47)(12,"span",48),n(13),y(14,"number"),i(),r(15,"span"),n(16,"x"),i(),r(17,"span",49),n(18),i()()(),r(19,"div",45),f(20,"div"),r(21,"div",50),n(22),y(23,"number"),i()()()()),e&2){let d,l,m,o,u=t.$implicit,v=t.index;p("formGroupName",v),a(10),c((d=u.get("productName"))==null?null:d.value),a(3),c(b(14,5,(l=u.get("salePrice"))==null?null:l.value,"1.2-2")),a(5),c((m=u.get("quantity"))==null?null:m.value),a(4),c(b(23,8,(o=u.get("amount"))==null?null:o.value,"1.2-2"))}}var X=(()=>{let t=class t{get items(){return this.orderFormGroup.get("items")}constructor(l,m,o,u,v,q,g,R){this.checkout=l,this.fb=m,this.productsHttp=o,this.ordersHttp=u,this.router=v,this.snackBar=q,this.activatedRoute=g,this.commonHttp=R,this.algeriaProvinces=[],this.errors=[],this.total=0,this.orderFormGroup=this.fb.group({id:[void 0],fullname:[{value:"",disabled:!0},[S.required]],province:[{value:"",disabled:!0},[S.required]],city:[{value:"",disabled:!0},[S.required]],address:[{value:"",disabled:!0},[S.required]],phoneNumber:[{value:"",disabled:!0},[S.required]],status:[{value:"",disabled:!1},[S.required]],deliveryCost:[0,[S.required]],notes:[""],items:this.fb.array([])})}ngAfterViewInit(){setTimeout(()=>{this.statusField.nativeElement.focus()},200)}ngOnInit(){this.params={mode:this.activatedRoute.snapshot.paramMap.get("mode"),id:this.activatedRoute.snapshot.paramMap.get("id")},this.orderFormGroup.valueChanges.subscribe({next:l=>this.errors=[]}),this.ordersHttp.getOrder(this.params.id).subscribe({next:l=>{this.orderFormGroup.patchValue({id:l.id,fullname:l.fullname,province:l.province,city:l.city,address:l.address,phoneNumber:l.phoneNumber,status:l.status,deliveryCost:l.deliveryCost,notes:l.notes}),this.total=l.total,l.items.forEach(m=>{this.items.push(this.fb.group({productId:m.id,productName:m.product.name,salePrice:m.salePrice,quantity:m.quantity,amount:m.amount}))})}}),this.commonHttp.allProvinces().subscribe({next:l=>{this.algeriaProvinces=l}})}saveOrder(){if(this.orderFormGroup.valid){let l=ee({},this.orderFormGroup.getRawValue());this.ordersHttp.updateOrder(l).subscribe({next:m=>{m.success&&(this.snackBar.open("Modification r\xE9ussie!","\u2705",{duration:5e3}),this.router.navigate(["/authenticated/orders"]))},error:m=>{console.error(m?.error?.errors)}})}else this.orderFormGroup.markAsTouched()}};t.\u0275fac=function(m){return new(m||t)(_(Ue),_(we),_(We),_(U),_(j),_(Q),_(ue),_(Te))},t.\u0275cmp=P({type:t,selectors:[["app-order-form"]],viewQuery:function(m,o){if(m&1&&T(rt,5),m&2){let u;D(u=M())&&(o.statusField=u.first)}},decls:79,vars:30,consts:[["statusField",""],[1,"flex","flex-col","flex-1"],[1,"flex","flex-row","items-center","bg-gray-100","py-4","px-32"],[1,"flex","flex-wrap","items-center","gap-x-2","mt-2","text-lg"],[1,"!text-lg","!text-black"],["class","flex flex-col gap-y-1 bg-red-100 my-4 mx-32 px-4 py-3 w-fit rounded-sm text-red-600",4,"ngIf"],[1,"flex","flex-wrap","justify-between","flex-1","px-28","py-6",3,"formGroup"],[1,"flex","flex-col","w-full","md:w-[calc(50%-8px)]","px-2","gap-y-3"],["formControlName","id","type","number",1,"!hidden"],[3,"required"],["myInput","","formControlName","fullname"],[4,"ngIf"],["myInput","","formControlName","phoneNumber"],["mat-flat-button","","color","accent",1,"!absolute","!right-1","!top-[26px]","!w-fit",3,"href"],[1,"ri-phone-fill"],["formControlName","province","myInput","","size","small",1,"!h-12"],[4,"ngFor","ngForOf"],["myInput","","formControlName","city",1,"!hidden"],["myInput","","disabled","",3,"value"],["myInput","","formControlName","address"],["myInput","","formControlName","status",1,"!border-2","!border-green-500"],["myTextarea","","formControlName","notes",1,"!border-2","!border-green-500"],["mat-flat-button","","color","primary",1,"!h-14","!mt-5","!w-fit","!px-10","!text-base",3,"click"],[1,"flex","flex-col","w-full","md:w-[calc(50%-8px)]","h-fit","px-8","bg-gray-50","mt-5","py-6"],[1,"flex","flex-row","items-center","justify-between"],[1,"!text-lg","text-black","!font-medium"],["formArrayName","items",1,"flex","flex-col","gap-y-2","mt-4"],["class","flex flex-col gap-y-2",3,"formGroupName",4,"ngFor","ngForOf"],[1,"border-b","border-b-gray-200"],[1,"flex","flex-row","items-center","justify-between","py-4"],[1,"!mt-2"],["formControlName","deliveryCost","type","number",1,"!hidden"],[1,"text-accent","text-lg","font-medium","bg-transparent","text-right"],[1,"flex","flex-col","py-8"],[1,"!text-2xl","!text-black"],[1,"!text-3xl","!font-medium","text-primary"],["checked","",1,"-ml-2"],[1,"flex","flex-col","gap-y-1","bg-red-100","my-4","mx-32","px-4","py-3","w-fit","rounded-sm","text-red-600"],[3,"value"],[1,"flex","flex-col","gap-y-2",3,"formGroupName"],["formControlName","productId","type","number",1,"!hidden"],["formControlName","productName","type","text",1,"!hidden"],["formControlName","salePrice","type","number",1,"!hidden"],["formControlName","quantity","type","number",1,"!hidden"],["formControlName","amount","type","number",1,"!hidden"],[1,"flex","flex-col"],[1,"bg-transparent","border-none"],[1,"flex","flex-row","items-center","gap-x-2"],[1,"text-primary","!text-lg"],[1,"text-base","text-black"],[1,"self-end","text-accent","text-xl","mt-11"]],template:function(m,o){if(m&1){let u=H();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"h4",4),n(4,"D\xE9tails de la commande"),i()()(),s(5,ot,2,1,"div",5),r(6,"form",6)(7,"div",7),f(8,"input",8),r(9,"my-form-field")(10,"my-label",9),n(11,"Nom et Pr\xE9nom"),i(),f(12,"input",10),s(13,at,2,0,"my-error",11),i(),r(14,"my-form-field")(15,"my-label",9),n(16,"T\xE9l\xE9phone"),i(),f(17,"input",12),s(18,lt,2,0,"my-error",11),r(19,"a",13),f(20,"i",14),n(21," Appeler "),i()(),r(22,"my-form-field")(23,"my-label",9),n(24,"Wilaya"),i(),r(25,"select",15),s(26,mt,3,2,"ng-container",16),i(),s(27,dt,2,0,"my-error",11),i(),r(28,"my-form-field")(29,"my-label",9),n(30,"Commune"),i(),f(31,"input",17)(32,"input",18),y(33,"appAlgeriaCity"),y(34,"async"),s(35,pt,2,0,"my-error",11),i(),r(36,"my-form-field")(37,"my-label",9),n(38,"Adresse"),i(),f(39,"input",19),s(40,st,2,0,"my-error",11),i(),r(41,"my-form-field")(42,"my-label",9),n(43,"\xC9tat"),i(),f(44,"input",20,0),s(46,ut,2,0,"my-error",11),i(),r(47,"my-form-field")(48,"my-label"),n(49,"Notes"),i(),f(50,"textarea",21),i(),r(51,"button",22),N("click",function(){return I(u),O(o.saveOrder())}),n(52,"Enregistrer"),i()(),r(53,"div",23)(54,"div",24)(55,"h5",25),n(56,"Produit"),i(),r(57,"h5",25),n(58,"Total"),i()(),r(59,"div",26),s(60,ct,24,11,"div",27),f(61,"div",28),i(),r(62,"div",29)(63,"h4",30),n(64,"Frais de livraison"),i(),f(65,"input",31),r(66,"span",32),n(67),y(68,"number"),i()(),f(69,"div",28),r(70,"div",33)(71,"div",24)(72,"h3",34),n(73,"Total"),i(),r(74,"span",35),n(75),y(76,"number"),i()(),r(77,"mat-radio-button",36),n(78,"Cash On Delivery (COD)"),i()()()()()}if(m&2){let u,v,q,g,R,w,F,G,Z;a(5),p("ngIf",o.errors.length>0),a(),p("formGroup",o.orderFormGroup),a(4),p("required",!0),a(3),p("ngIf",((u=o.orderFormGroup.get("fullname"))==null?null:u.invalid)&&(((u=o.orderFormGroup.get("fullname"))==null?null:u.dirty)||((u=o.orderFormGroup.get("fullname"))==null?null:u.touched))&&((u=o.orderFormGroup.get("fullname"))==null?null:u.getError("required"))),a(2),p("required",!0),a(3),p("ngIf",(((v=o.orderFormGroup.get("phoneNumber"))==null?null:v.dirty)||((v=o.orderFormGroup.get("phoneNumber"))==null?null:v.touched))&&((v=o.orderFormGroup.get("phoneNumber"))==null?null:v.getError("required"))),a(),p("href","tel:+"+((q=o.orderFormGroup.get("phoneNumber"))==null?null:q.value),me),a(4),p("required",!0),a(3),p("ngForOf",o.algeriaProvinces),a(),p("ngIf",(((g=o.orderFormGroup.get("province"))==null?null:g.dirty)||((g=o.orderFormGroup.get("province"))==null?null:g.touched))&&((g=o.orderFormGroup.get("province"))==null?null:g.getError("required"))),a(2),p("required",!0),a(3),p("value",C(34,22,C(33,20,(R=o.orderFormGroup.get("city"))==null?null:R.value))),a(3),p("ngIf",(((w=o.orderFormGroup.get("city"))==null?null:w.dirty)||((w=o.orderFormGroup.get("city"))==null?null:w.touched))&&((w=o.orderFormGroup.get("city"))==null?null:w.getError("required"))),a(2),p("required",!0),a(3),p("ngIf",(((F=o.orderFormGroup.get("address"))==null?null:F.dirty)||((F=o.orderFormGroup.get("address"))==null?null:F.touched))&&((F=o.orderFormGroup.get("address"))==null?null:F.getError("required"))),a(2),p("required",!0),a(4),p("ngIf",(((G=o.orderFormGroup.get("status"))==null?null:G.dirty)||((G=o.orderFormGroup.get("status"))==null?null:G.touched))&&((G=o.orderFormGroup.get("status"))==null?null:G.getError("required"))),a(14),p("ngForOf",o.items.controls),a(7),c(b(68,24,(Z=o.orderFormGroup.get("deliveryCost"))==null?null:Z.value,"1.2-2")),a(8),c(b(76,27,o.total,"1.2-2"))}},dependencies:[pe,B,xe,Se,Ee,ce,ye,be,fe,he,_e,Ce,ve,ge,qe,Me,ze,Ie,Ne,Fe,Ge,Oe,V,$,L],styles:[`app-order-form{display:flex;flex:1}
`],encapsulation:2});let e=t;return e})();var ft=()=>[5,10,20,30,50,100];function ht(e,t){e&1&&(r(0,"th",24),n(1,"Nom et Pr\xE9nom"),i())}function xt(e,t){if(e&1&&(r(0,"td",25),n(1),i()),e&2){let d=t.$implicit;a(),c(d.fullname)}}function yt(e,t){e&1&&(r(0,"th",24),n(1,"Num T\xE9l"),i())}function _t(e,t){if(e&1&&(r(0,"td",25),n(1),i()),e&2){let d=t.$implicit;a(),c(d.phoneNumber)}}function vt(e,t){e&1&&(r(0,"th",24),n(1,"Wilaya"),i())}function gt(e,t){if(e&1&&(r(0,"td",25),n(1),y(2,"appAlgeriaProvince"),y(3,"async"),i()),e&2){let d=t.$implicit;a(),c(C(3,3,C(2,1,d.province)))}}function Ct(e,t){e&1&&(r(0,"th",24),n(1,"Ville"),i())}function bt(e,t){if(e&1&&(r(0,"td",25),n(1),y(2,"appAlgeriaCity"),y(3,"async"),i()),e&2){let d=t.$implicit;a(),c(C(3,3,C(2,1,d.city)))}}function St(e,t){e&1&&(r(0,"th",24),n(1,"Adresse"),i())}function Et(e,t){if(e&1&&(r(0,"td",25),n(1),i()),e&2){let d=t.$implicit;a(),c(d.address)}}function wt(e,t){e&1&&(r(0,"th",24),n(1,"Livraion"),i())}function Ft(e,t){if(e&1&&(r(0,"td",25),n(1),i()),e&2){let d=t.$implicit;a(),c(d.deliveryDestination=="homeDelivery"?"\xC0 Domicile":"Au Bureau")}}function Gt(e,t){e&1&&(r(0,"th",24),n(1,"Frais de livraison"),i())}function It(e,t){if(e&1&&(r(0,"td",25),n(1),y(2,"number"),i()),e&2){let d=t.$implicit;a(),c(b(2,1,d.deliveryCost,"1.2-2"))}}function Ot(e,t){e&1&&(r(0,"th",24),n(1,"Total"),i())}function Nt(e,t){if(e&1&&(r(0,"td",25),n(1),i()),e&2){let d=t.$implicit;a(),c(d.total)}}function Tt(e,t){e&1&&(r(0,"th",24),n(1,"Quantit\xE9 en Stock"),i())}function Dt(e,t){if(e&1&&(r(0,"td",25),n(1),i()),e&2){let d=t.$implicit;a(),c(d.quantityInStock)}}function Mt(e,t){e&1&&(r(0,"th",24),n(1,"status"),i())}function qt(e,t){if(e&1&&(r(0,"div",28),n(1),i()),e&2){let d=E().$implicit;a(),c(d.status)}}function Rt(e,t){if(e&1&&(r(0,"div",29),n(1),i()),e&2){let d=E().$implicit;a(),c(d.status)}}function kt(e,t){if(e&1&&(r(0,"td",25),s(1,qt,2,1,"div",26)(2,Rt,2,1,"div",27),i()),e&2){let d=t.$implicit;a(),p("ngIf",d.status=="En attente"),a(),p("ngIf",d.status!="En attente")}}function Pt(e,t){e&1&&(r(0,"th",24),n(1,"Date"),i())}function At(e,t){if(e&1&&(r(0,"td",25),n(1),y(2,"date"),i()),e&2){let d=t.$implicit;a(),c(b(2,1,d.date,"dd/MM/yyyy"))}}function Ht(e,t){e&1&&(r(0,"th",30),n(1,"Action"),i())}function Bt(e,t){if(e&1){let d=H();r(0,"td",25)(1,"div",31)(2,"button",32),N("click",function(){let m=I(d).$implicit,o=E();return O(o.deleteItem(m.id))}),f(3,"i",33),i(),r(4,"button",32),N("click",function(){let m=I(d).$implicit,o=E();return O(o.newItem("edit",m.id))}),f(5,"i",34),i()()()}}function Vt(e,t){e&1&&f(0,"tr",35)}function $t(e,t){e&1&&f(0,"tr",36)}var Y=(()=>{let t=class t{constructor(l,m,o){this.ordersHttp=l,this.snackbar=m,this.router=o,this.displayedColumns=["fullname","phoneNumber","province","city","address","deliveryDestination","deliveryCost","total","date","status","actions"],this.data=[],this.resultsLength=0,this.isLoadingResults=!0,this.isRateLimitReached=!1,this.refresh=new le}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),re(this.sort.sortChange,this.paginator.page,this.refresh).pipe(oe({}),ae(()=>(this.isLoadingResults=!0,this.ordersHttp.paginateOrders(this.sort.active,this.sort.direction,this.paginator.pageIndex,this.paginator.pageSize).pipe(ne(()=>te(null))))),ie(l=>(this.isLoadingResults=!1,this.isRateLimitReached=l?.items?.length==0,l?.items===null?[]:(this.resultsLength=l?.totalCount,l?.items)))).subscribe(l=>this.data=l)}ngOnInit(){}newItem(l="creation",m=0){this.router.navigate([`/authenticated/orders/${l}/${m}`])}deleteItem(l){confirm("\xCAtes-vous s\xFBr de l'avoir fait?")&&this.ordersHttp.deleteOrder(l).subscribe({next:m=>{this.refresh.emit(),this.snackbar.open("La suppression a \xE9t\xE9 r\xE9ussie","\u2705",{duration:6e3})}})}};t.\u0275fac=function(m){return new(m||t)(_(U),_(Q),_(j))},t.\u0275cmp=P({type:t,selectors:[["app-orders-grid"]],viewQuery:function(m,o){if(m&1&&(T(z,5),T(W,5)),m&2){let u;D(u=M())&&(o.paginator=u.first),D(u=M())&&(o.sort=u.first)}},decls:46,vars:9,consts:[[1,"flex","flex-col","flex-1"],[1,"flex","flex-row","justify-start","items-center","px-6","py-4"],[1,"text-xl","font-medium","text-black"],[1,"flex","flex-col","m-6","shadow"],[1,"max-h-[calc(100vh-300px)]","overflow-auto"],["mat-table","","matSort","","matSortActive","id","matSortDisableClear","","matSortDirection","desc",3,"dataSource"],["matColumnDef","fullname"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","phoneNumber"],["matColumnDef","province"],["matColumnDef","city"],["matColumnDef","address"],["matColumnDef","deliveryDestination"],["matColumnDef","deliveryCost"],["matColumnDef","total"],["matColumnDef","quantityInStock"],["matColumnDef","status"],["matColumnDef","date"],["matColumnDef","actions"],["mat-header-cell","","class","!text-center w-20 ",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"pageSizeOptions","length","pageSize","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["class","px-2 py-[2px] bg-red-100 text-red-600 w-fit rounded",4,"ngIf"],["class","px-2 py-[2px] bg-blue-200 text-blue-600 w-fit rounded",4,"ngIf"],[1,"px-2","py-[2px]","bg-red-100","text-red-600","w-fit","rounded"],[1,"px-2","py-[2px]","bg-blue-200","text-blue-600","w-fit","rounded"],["mat-header-cell","",1,"!text-center","w-20"],[1,"flex","flex-row","items-center","space-x-2"],["mat-icon-button","",3,"click"],[1,"ri-delete-bin-6-line","text-red-600"],[1,"ri-pencil-line"],["mat-header-row",""],["mat-row",""]],template:function(m,o){m&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),n(3,"Commandes"),i()(),r(4,"div",3)(5,"div",4)(6,"table",5),h(7,6),s(8,ht,2,0,"th",7)(9,xt,2,1,"td",8),x(),h(10,9),s(11,yt,2,0,"th",7)(12,_t,2,1,"td",8),x(),h(13,10),s(14,vt,2,0,"th",7)(15,gt,4,5,"td",8),x(),h(16,11),s(17,Ct,2,0,"th",7)(18,bt,4,5,"td",8),x(),h(19,12),s(20,St,2,0,"th",7)(21,Et,2,1,"td",8),x(),h(22,13),s(23,wt,2,0,"th",7)(24,Ft,2,1,"td",8),x(),h(25,14),s(26,Gt,2,0,"th",7)(27,It,3,4,"td",8),x(),h(28,15),s(29,Ot,2,0,"th",7)(30,Nt,2,1,"td",8),x(),h(31,16),s(32,Tt,2,0,"th",7)(33,Dt,2,1,"td",8),x(),h(34,17),s(35,Mt,2,0,"th",7)(36,kt,3,2,"td",8),x(),h(37,18),s(38,Pt,2,0,"th",7)(39,At,3,4,"td",8),x(),h(40,19),s(41,Ht,2,0,"th",20)(42,Bt,6,0,"td",8),x(),s(43,Vt,1,0,"tr",21)(44,$t,1,0,"tr",22),i()(),f(45,"mat-paginator",23),i()()),m&2&&(a(6),p("dataSource",o.data),a(37),p("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky",!0),a(),p("matRowDefColumns",o.displayedColumns),a(),p("pageSizeOptions",de(8,ft))("length",o.resultsLength)("pageSize",20)("showFirstLastButtons",!0))},dependencies:[B,Re,ke,Ae,$e,He,Pe,je,Be,Ve,Le,Qe,z,W,V,$,se,De,L],styles:[`app-orders-grid{display:flex;flex:1}
`],encapsulation:2});let e=t;return e})();var jt=[{path:"",redirectTo:"orders",pathMatch:"full"},{path:"",component:Y},{path:":mode/:id",component:X}],Ke=(()=>{let t=class t{};t.\u0275fac=function(m){return new(m||t)},t.\u0275mod=A({type:t}),t.\u0275inj=k({imports:[J.forChild(jt),J]});let e=t;return e})();var Ci=(()=>{let t=class t{};t.\u0275fac=function(m){return new(m||t)},t.\u0275mod=A({type:t}),t.\u0275inj=k({imports:[Je,Ke]});let e=t;return e})();export{Ci as OrdersModule};
