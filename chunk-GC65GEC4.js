import{Aa as re,Ab as k,Ca as oe,D as f,F as c,Fa as ae,G as s,H as n,Hb as _e,I as d,J as V,Ja as ne,K as H,Ka as se,L as M,La as me,M as g,Ma as le,N as y,Na as ce,P as x,Q as v,R as w,S as l,T as _,Va as I,W,Xa as pe,aa as J,ba as K,e as Q,f as B,fb as R,g as A,h as $,j as q,k as z,lb as de,mb as ue,n as b,na as U,nb as fe,ob as ge,pa as E,pb as he,q as S,qa as X,qb as Ce,r as F,rb as ye,s as h,sb as xe,t as C,ta as N,tb as ve,u as P,ua as Y,ub as we,va as Z,wa as ee,wb as G,xa as te,xb as D,y as m,z as p,za as ie}from"./chunk-VQKOQMAP.js";var Ie=["nameField"];function Re(i,e){if(i&1&&(s(0,"li"),l(1),n()),i&2){let u=e.$implicit;m(),_(u)}}function Ge(i,e){if(i&1&&(s(0,"div",12),f(1,Re,2,1,"li",13),n()),i&2){let u=y();m(),c("ngForOf",u.errors)}}function De(i,e){i&1&&(s(0,"my-error"),l(1,"Champ obligatoire"),n())}var L=(()=>{let e=class e{constructor(t,r,o,a,O){this.fb=t,this.route=r,this.categoriesHttp=o,this.snackbar=a,this.router=O,this.errors=[],this.categoryFormGroup=this.fb.group({id:[void 0],name:["",[Z.required]]})}ngAfterViewInit(){setTimeout(()=>{this.nameField.nativeElement.focus()},300)}ngOnInit(){this.params={mode:this.route.snapshot.paramMap.get("mode"),id:this.route.snapshot.paramMap.get("id")},this.categoryFormGroup.valueChanges.subscribe({next:t=>this.errors=[]}),this.params.mode=="edit"&&this.categoriesHttp.getCategory(this.params.id).subscribe({next:t=>{this.categoryFormGroup.patchValue({id:t.id,name:t.name})}})}saveCategory(){this.params.mode=="creation"?this.categoriesHttp.createCategory(this.categoryFormGroup.getRawValue()).subscribe({next:t=>{t.success&&(this.snackbar.open("Cr\xE9ation r\xE9ussie!","\u2705",{duration:6e3}),this.router.navigate(["/authenticated/categories"]))},error:t=>{console.log(t),this.errors.push(t.error.errors.name)}}):this.categoriesHttp.updateCategory(this.categoryFormGroup.getRawValue()).subscribe({next:t=>{t.success&&(this.snackbar.open(t.message,"\u2705",{duration:6e3}),this.router.navigate(["/authenticated/categories"]))},error:t=>{console.log(t),this.errors.push(t.error.errors.name)}})}};e.\u0275fac=function(r){return new(r||e)(p(ne),p(U),p(k),p(R),p(E))},e.\u0275cmp=S({type:e,selectors:[["app-category-form"]],viewQuery:function(r,o){if(r&1&&x(Ie,5),r&2){let a;v(a=w())&&(o.nameField=a.first)}},decls:18,vars:5,consts:[["nameField",""],[1,"flex","flex-col","flex-1"],[1,"flex","flex-row","items-center","p-5"],[1,"text-black","font-medium","text-xl"],["class","flex flex-col gap-y-1 bg-red-100 my-4 mx-5 px-4 py-3 w-fit rounded-sm text-red-600",4,"ngIf"],[1,"mt-6","px-5",3,"formGroup"],["formControlName","id","type","number",1,"!hidden"],["myInput","","formControlName","name",1,"!max-w-72"],[4,"ngIf"],[1,"flex","flex-row","p-5","gap-x-6"],["mat-stroked-button","","color","primary","routerLink","/authenticated/categories"],["mat-flat-button","","color","primary",3,"click","disabled"],[1,"flex","flex-col","gap-y-1","bg-red-100","my-4","mx-5","px-4","py-3","w-fit","rounded-sm","text-red-600"],[4,"ngFor","ngForOf"]],template:function(r,o){if(r&1){let a=M();s(0,"div",1)(1,"div",2)(2,"div",3),l(3),n()(),f(4,Ge,2,1,"div",4),s(5,"form",5),d(6,"input",6),s(7,"my-form-field")(8,"my-label"),l(9,"Nom"),n(),d(10,"input",7,0),f(12,De,2,0,"my-error",8),n()(),s(13,"div",9)(14,"button",10),l(15,"Retour"),n(),s(16,"button",11),g("click",function(){return h(a),C(o.saveCategory())}),l(17,"Enregistrer"),n()()()}if(r&2){let a;m(3),_(o.params.mode=="creation"?"Nouvelle Cat\xE9gorie":"Modifier Cat\xE9gorie"),m(),c("ngIf",o.errors.length>0),m(),c("formGroup",o.categoryFormGroup),m(7),c("ngIf",(((a=o.categoryFormGroup.get("name"))==null?null:a.dirty)||((a=o.categoryFormGroup.get("name"))==null?null:a.touched))&&((a=o.categoryFormGroup.get("name"))==null?null:a.getError("required"))),m(4),c("disabled",o.categoryFormGroup.invalid)}},dependencies:[J,K,X,ie,Y,re,ee,te,oe,ae,I,le,se,me,ce],styles:[`app-category-form{display:flex;flex:1}
`],encapsulation:2});let i=e;return i})();var ke=()=>[5,10,20,30,50,100];function Ve(i,e){i&1&&(s(0,"th",16),l(1,"Cat\xE9gorie"),n())}function He(i,e){if(i&1&&(s(0,"td",17),l(1),n()),i&2){let u=e.$implicit;m(),_(u.name)}}function Ne(i,e){i&1&&(s(0,"th",18),l(1,"Action"),n())}function Te(i,e){if(i&1){let u=M();s(0,"td",17)(1,"div",19)(2,"button",20),g("click",function(){let r=h(u).$implicit,o=y();return C(o.deleteItem(r.id))}),d(3,"i",21),n(),s(4,"button",20),g("click",function(){let r=h(u).$implicit,o=y();return C(o.newItem("edit",r.id))}),d(5,"i",22),n()()()}}function Le(i,e){i&1&&d(0,"tr",23)}function je(i,e){i&1&&d(0,"tr",24)}var j=(()=>{let e=class e{constructor(t,r,o){this.categoriesHttp=t,this.snackbar=r,this.router=o,this.displayedColumns=["name","actions"],this.data=[],this.resultsLength=0,this.isLoadingResults=!0,this.isRateLimitReached=!1,this.refresh=new P}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),A(this.sort.sortChange,this.paginator.page,this.refresh).pipe(q({}),z(()=>(this.isLoadingResults=!0,this.categoriesHttp.paginateCategories(this.sort.active,this.sort.direction,this.paginator.pageIndex,this.paginator.pageSize).pipe($(()=>Q(null))))),B(t=>(this.isLoadingResults=!1,this.isRateLimitReached=t.items.length==0,t.items===null?[]:(this.resultsLength=t.totalCount,t.items)))).subscribe(t=>this.data=t)}ngOnInit(){}newItem(t="creation",r=0){this.router.navigate([`/authenticated/categories/${t}/${r}`])}deleteItem(t){confirm("\xCAtes-vous s\xFBr de l'avoir fait?")&&this.categoriesHttp.deleteCategory(t).subscribe({next:r=>{this.refresh.emit(),this.snackbar.open("La suppression a \xE9t\xE9 r\xE9ussie","\u2705",{duration:6e3})}})}};e.\u0275fac=function(r){return new(r||e)(p(k),p(R),p(E))},e.\u0275cmp=S({type:e,selectors:[["app-categories-grid"]],viewQuery:function(r,o){if(r&1&&(x(G,5),x(D,5)),r&2){let a;v(a=w())&&(o.paginator=a.first),v(a=w())&&(o.sort=a.first)}},decls:19,vars:9,consts:[[1,"flex","flex-col","flex-1"],[1,"flex","flex-row","justify-between","items-center","px-6","py-4"],[1,"text-xl","font-medium","text-black"],["mat-flat-button","","color","primary",3,"click"],[1,"ri-add-line","text-lg"],[1,"flex","flex-col","m-6","shadow"],[1,"max-h-[calc(100vh-300px)]","overflow-auto"],["mat-table","","matSort","","matSortActive","id","matSortDisableClear","","matSortDirection","desc",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","!text-center w-20 ",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"pageSizeOptions","length","pageSize","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"!text-center","w-20"],[1,"flex","flex-row","items-center","space-x-2"],["mat-icon-button","",3,"click"],[1,"ri-delete-bin-6-line","text-red-600"],[1,"ri-pencil-line"],["mat-header-row",""],["mat-row",""]],template:function(r,o){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),l(3,"Cat\xE9gories"),n(),s(4,"button",3),g("click",function(){return o.newItem()}),d(5,"i",4),l(6," Nouvelle Cat\xE9gorie"),n()(),s(7,"div",5)(8,"div",6)(9,"table",7),V(10,8),f(11,Ve,2,0,"th",9)(12,He,2,1,"td",10),H(),V(13,11),f(14,Ne,2,0,"th",12)(15,Te,6,0,"td",10),H(),f(16,Le,1,0,"tr",13)(17,je,1,0,"tr",14),n()(),d(18,"mat-paginator",15),n()()),r&2&&(m(9),c("dataSource",o.data),m(7),c("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky",!0),m(),c("matRowDefColumns",o.displayedColumns),m(),c("pageSizeOptions",W(8,ke))("length",o.resultsLength)("pageSize",20)("showFirstLastButtons",!0))},dependencies:[I,pe,de,fe,ye,ge,ue,xe,he,Ce,ve,we,G,D],styles:[`app-categories-grid{display:flex;flex:1}
`],encapsulation:2});let i=e;return i})();var Oe=[{path:"",redirectTo:"categories",pathMatch:"full"},{path:"",component:j},{path:":mode/:id",component:L}],be=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=F({type:e}),e.\u0275inj=b({imports:[N.forChild(Oe),N]});let i=e;return i})();var ft=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=F({type:e}),e.\u0275inj=b({imports:[_e,be]});let i=e;return i})();export{ft as CategoriesModule};
