import{Ab as $e,Ba as ue,Ca as ce,D as u,Db as Be,Ea as fe,Eb as Le,F as p,Fa as xe,G as r,Ga as he,Gb as B,H as i,Ha as ve,I as c,Ia as _e,J as x,Ja as ye,Jb as Qe,K as h,Ka as ge,L as q,La as Ce,M as G,Ma as be,N as b,Na as Se,Oa as Ee,P as O,Pa as we,Q as N,Qa as Fe,R as T,S as n,T as f,Va as Ie,W as ne,Wa as Ge,X as y,Xa as Oe,Y as oe,Ya as Ne,Z as C,Za as Te,a as J,ca as ae,da as V,e as K,f as X,fa as le,g as Y,ga as H,h as Z,hb as j,j as ee,k as te,n as M,nb as De,ob as Me,pa as me,pb as Re,q as R,qb as ke,r as k,ra as A,rb as qe,s as F,sb as Ve,t as I,tb as He,u as ie,ub as Ae,va as L,vb as je,wa as de,wb as Pe,x as re,xa as S,y as l,ya as pe,yb as P,z as v,za as se,zb as $}from"./chunk-NGVNHCGD.js";var Ye=["statusField"];function Ze(e,t){if(e&1&&(r(0,"li"),n(1),i()),e&2){let d=t.$implicit;l(),f(d)}}function et(e,t){if(e&1&&(r(0,"div",35),u(1,Ze,2,1,"li",16),i()),e&2){let d=b();l(),p("ngForOf",d.errors)}}function tt(e,t){e&1&&(r(0,"my-error"),n(1," Veuillez remplir ce champ. "),i())}function it(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function rt(e,t){if(e&1&&(x(0),r(1,"option",36),n(2),i(),h()),e&2){let d=t.$implicit;l(),p("value",d.code),l(),f(d.name)}}function nt(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function ot(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function at(e,t){e&1&&(r(0,"my-error"),n(1," Champ obligatoire"),i())}function lt(e,t){if(e&1&&(r(0,"div",37),c(1,"div",26),r(2,"div",22),c(3,"input",38)(4,"input",39)(5,"input",40)(6,"input",41)(7,"input",42),r(8,"div",43)(9,"h3",44),n(10),i(),r(11,"div",45)(12,"span",46),n(13),y(14,"number"),i(),r(15,"span"),n(16,"x"),i(),r(17,"span",47),n(18),i()()(),r(19,"div",43),c(20,"div"),r(21,"div",48),n(22),y(23,"number"),i()()()()),e&2){let d,m,a,o,s=t.$implicit,_=t.index;p("formGroupName",_),l(10),f((d=s.get("productName"))==null?null:d.value),l(3),f(C(14,5,(m=s.get("salePrice"))==null?null:m.value,"1.2-2")),l(5),f((a=s.get("quantity"))==null?null:a.value),l(4),f(C(23,8,(o=s.get("amount"))==null?null:o.value,"1.2-2"))}}var z=(()=>{let t=class t{get items(){return this.orderFormGroup.get("items")}constructor(m,a,o,s,_,D,g){this.checkout=m,this.fb=a,this.productsHttp=o,this.ordersHttp=s,this.router=_,this.snackBar=D,this.activatedRoute=g,this.provinces=Ie,this.errors=[],this.total=0,this.orderFormGroup=this.fb.group({id:[void 0],fullname:[{value:"",disabled:!0},[S.required]],province:[{value:"",disabled:!0},[S.required]],address:[{value:"",disabled:!0},[S.required]],phoneNumber:[{value:"",disabled:!0},[S.required]],status:[{value:"",disabled:!1},[S.required]],deliveryCost:[0,[S.required]],notes:[""],items:this.fb.array([])})}ngAfterViewInit(){setTimeout(()=>{this.statusField.nativeElement.focus()},200)}ngOnInit(){this.params={mode:this.activatedRoute.snapshot.paramMap.get("mode"),id:this.activatedRoute.snapshot.paramMap.get("id")},this.orderFormGroup.valueChanges.subscribe({next:m=>this.errors=[]}),this.ordersHttp.getOrder(this.params.id).subscribe({next:m=>{this.orderFormGroup.patchValue({id:m.id,fullname:m.fullname,province:m.province,address:m.address,phoneNumber:m.phoneNumber,status:m.status,deliveryCost:m.deliveryCost,notes:m.notes}),this.total=m.total,m.items.forEach(a=>{this.items.push(this.fb.group({productId:a.id,productName:a.product.name,salePrice:a.salePrice,quantity:a.quantity,amount:a.amount}))})}})}saveOrder(){if(this.orderFormGroup.valid){let m=J({},this.orderFormGroup.getRawValue());this.ordersHttp.updateOrder(m).subscribe({next:a=>{a.success&&(this.snackBar.open("Modification r\xE9ussie!","\u2705",{duration:5e3}),this.router.navigate(["/authenticated/orders"]))},error:a=>{console.error(a?.error?.errors)}})}else this.orderFormGroup.markAsTouched()}};t.\u0275fac=function(a){return new(a||t)(v(Le),v(Ce),v(Be),v(B),v(A),v(j),v(me))},t.\u0275cmp=R({type:t,selectors:[["app-order-form"]],viewQuery:function(a,o){if(a&1&&O(Ye,5),a&2){let s;N(s=T())&&(o.statusField=s.first)}},decls:71,vars:23,consts:[["statusField",""],[1,"flex","flex-col","flex-1"],[1,"flex","flex-row","items-center","bg-gray-100","py-4","px-32"],[1,"flex","flex-wrap","items-center","gap-x-2","mt-2","text-lg"],[1,"!text-lg","!text-black"],["class","flex flex-col gap-y-1 bg-red-100 my-4 mx-32 px-4 py-3 w-fit rounded-sm text-red-600",4,"ngIf"],[1,"flex","flex-wrap","justify-between","flex-1","px-28","py-6",3,"formGroup"],[1,"flex","flex-col","w-full","md:w-[calc(50%-8px)]","px-2","gap-y-3"],["formControlName","id","type","number",1,"!hidden"],[3,"required"],["myInput","","formControlName","fullname"],[4,"ngIf"],["myInput","","formControlName","phoneNumber"],["mat-flat-button","","color","accent",1,"!absolute","!right-1","!top-[26px]","!w-fit",3,"href"],[1,"ri-phone-fill"],["formControlName","province","myInput","","size","small",1,"!h-12"],[4,"ngFor","ngForOf"],["myInput","","formControlName","address"],["myInput","","formControlName","status",1,"!border-2","!border-green-500"],["myTextarea","","formControlName","notes",1,"!border-2","!border-green-500"],["mat-flat-button","","color","primary",1,"!h-14","!mt-5","!w-fit","!px-10","!text-base",3,"click"],[1,"flex","flex-col","w-full","md:w-[calc(50%-8px)]","h-fit","px-8","bg-gray-50","mt-5","py-6"],[1,"flex","flex-row","items-center","justify-between"],[1,"!text-lg","text-black","!font-medium"],["formArrayName","items",1,"flex","flex-col","gap-y-2","mt-4"],["class","flex flex-col gap-y-2",3,"formGroupName",4,"ngFor","ngForOf"],[1,"border-b","border-b-gray-200"],[1,"flex","flex-row","items-center","justify-between","py-4"],[1,"!mt-2"],["formControlName","deliveryCost","type","number",1,"!hidden"],[1,"text-accent","text-lg","font-medium","bg-transparent","text-right"],[1,"flex","flex-col","py-8"],[1,"!text-2xl","!text-black"],[1,"!text-3xl","!font-medium","text-primary"],["checked","",1,"-ml-2"],[1,"flex","flex-col","gap-y-1","bg-red-100","my-4","mx-32","px-4","py-3","w-fit","rounded-sm","text-red-600"],[3,"value"],[1,"flex","flex-col","gap-y-2",3,"formGroupName"],["formControlName","productId","type","number",1,"!hidden"],["formControlName","productName","type","text",1,"!hidden"],["formControlName","salePrice","type","number",1,"!hidden"],["formControlName","quantity","type","number",1,"!hidden"],["formControlName","amount","type","number",1,"!hidden"],[1,"flex","flex-col"],[1,"bg-transparent","border-none"],[1,"flex","flex-row","items-center","gap-x-2"],[1,"text-primary","!text-lg"],[1,"text-base","text-black"],[1,"self-end","text-accent","text-xl","mt-11"]],template:function(a,o){if(a&1){let s=q();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"h4",4),n(4,"D\xE9tails de la commande"),i()()(),u(5,et,2,1,"div",5),r(6,"form",6)(7,"div",7),c(8,"input",8),r(9,"my-form-field")(10,"my-label",9),n(11,"Nom et Pr\xE9nom"),i(),c(12,"input",10),u(13,tt,2,0,"my-error",11),i(),r(14,"my-form-field")(15,"my-label",9),n(16,"T\xE9l\xE9phone"),i(),c(17,"input",12),u(18,it,2,0,"my-error",11),r(19,"a",13),c(20,"i",14),n(21," Appeler "),i()(),r(22,"my-form-field")(23,"my-label",9),n(24,"Wilaya"),i(),r(25,"select",15),u(26,rt,3,2,"ng-container",16),i(),u(27,nt,2,0,"my-error",11),i(),r(28,"my-form-field")(29,"my-label",9),n(30,"Commune et Adresse de livraison"),i(),c(31,"input",17),u(32,ot,2,0,"my-error",11),i(),r(33,"my-form-field")(34,"my-label",9),n(35,"\xC9tat"),i(),c(36,"input",18,0),u(38,at,2,0,"my-error",11),i(),r(39,"my-form-field")(40,"my-label"),n(41,"Notes"),i(),c(42,"textarea",19),i(),r(43,"button",20),G("click",function(){return F(s),I(o.saveOrder())}),n(44,"Enregistrer"),i()(),r(45,"div",21)(46,"div",22)(47,"h5",23),n(48,"Produit"),i(),r(49,"h5",23),n(50,"Total"),i()(),r(51,"div",24),u(52,lt,24,11,"div",25),c(53,"div",26),i(),r(54,"div",27)(55,"h4",28),n(56,"Frais de livraison"),i(),c(57,"input",29),r(58,"span",30),n(59),y(60,"number"),i()(),c(61,"div",26),r(62,"div",31)(63,"div",22)(64,"h3",32),n(65,"Total"),i(),r(66,"span",33),n(67),y(68,"number"),i()(),r(69,"mat-radio-button",34),n(70,"Cash On Delivery (COD)"),i()()()()()}if(a&2){let s,_,D,g,E,w,U;l(5),p("ngIf",o.errors.length>0),l(),p("formGroup",o.orderFormGroup),l(4),p("required",!0),l(3),p("ngIf",((s=o.orderFormGroup.get("fullname"))==null?null:s.invalid)&&(((s=o.orderFormGroup.get("fullname"))==null?null:s.dirty)||((s=o.orderFormGroup.get("fullname"))==null?null:s.touched))&&((s=o.orderFormGroup.get("fullname"))==null?null:s.getError("required"))),l(2),p("required",!0),l(3),p("ngIf",(((_=o.orderFormGroup.get("phoneNumber"))==null?null:_.dirty)||((_=o.orderFormGroup.get("phoneNumber"))==null?null:_.touched))&&((_=o.orderFormGroup.get("phoneNumber"))==null?null:_.getError("required"))),l(),p("href","tel:+"+((D=o.orderFormGroup.get("phoneNumber"))==null?null:D.value),re),l(4),p("required",!0),l(3),p("ngForOf",o.provinces),l(),p("ngIf",(((g=o.orderFormGroup.get("province"))==null?null:g.dirty)||((g=o.orderFormGroup.get("province"))==null?null:g.touched))&&((g=o.orderFormGroup.get("province"))==null?null:g.getError("required"))),l(2),p("required",!0),l(3),p("ngIf",(((E=o.orderFormGroup.get("address"))==null?null:E.dirty)||((E=o.orderFormGroup.get("address"))==null?null:E.touched))&&((E=o.orderFormGroup.get("address"))==null?null:E.getError("required"))),l(2),p("required",!0),l(4),p("ngIf",(((w=o.orderFormGroup.get("status"))==null?null:w.dirty)||((w=o.orderFormGroup.get("status"))==null?null:w.touched))&&((w=o.orderFormGroup.get("status"))==null?null:w.getError("required"))),l(14),p("ngForOf",o.items.controls),l(7),f(C(60,17,(U=o.orderFormGroup.get("deliveryCost"))==null?null:U.value,"1.2-2")),l(8),f(C(68,20,o.total,"1.2-2"))}},dependencies:[ae,V,ue,ye,ge,de,ce,_e,pe,se,fe,ve,xe,he,Ne,Oe,$e,Ee,Fe,be,Se,we,H],styles:[`app-order-form{display:flex;flex:1}
`],encapsulation:2});let e=t;return e})();var mt=()=>[5,10,20,30,50,100];function dt(e,t){e&1&&(r(0,"th",22),n(1,"Nom et Pr\xE9nom"),i())}function pt(e,t){if(e&1&&(r(0,"td",23),n(1),i()),e&2){let d=t.$implicit;l(),f(d.fullname)}}function st(e,t){e&1&&(r(0,"th",22),n(1,"Num T\xE9l"),i())}function ut(e,t){if(e&1&&(r(0,"td",23),n(1),i()),e&2){let d=t.$implicit;l(),f(d.phoneNumber)}}function ct(e,t){e&1&&(r(0,"th",22),n(1,"Adresse"),i())}function ft(e,t){if(e&1&&(r(0,"td",23),n(1),i()),e&2){let d=t.$implicit;l(),f(d.address)}}function xt(e,t){e&1&&(r(0,"th",22),n(1,"Wilaya"),i())}function ht(e,t){if(e&1&&(r(0,"td",23),n(1),y(2,"appAlgeriaProvince"),i()),e&2){let d=t.$implicit;l(),f(oe(2,1,d.province))}}function vt(e,t){e&1&&(r(0,"th",22),n(1,"Frais de livraison"),i())}function _t(e,t){if(e&1&&(r(0,"td",23),n(1),y(2,"number"),i()),e&2){let d=t.$implicit;l(),f(C(2,1,d.deliveryCost,"1.2-2"))}}function yt(e,t){e&1&&(r(0,"th",22),n(1,"Total"),i())}function gt(e,t){if(e&1&&(r(0,"td",23),n(1),i()),e&2){let d=t.$implicit;l(),f(d.total)}}function Ct(e,t){e&1&&(r(0,"th",22),n(1,"Quantit\xE9 en Stock"),i())}function bt(e,t){if(e&1&&(r(0,"td",23),n(1),i()),e&2){let d=t.$implicit;l(),f(d.quantityInStock)}}function St(e,t){e&1&&(r(0,"th",22),n(1,"status"),i())}function Et(e,t){if(e&1&&(r(0,"div",26),n(1),i()),e&2){let d=b().$implicit;l(),f(d.status)}}function wt(e,t){if(e&1&&(r(0,"div",27),n(1),i()),e&2){let d=b().$implicit;l(),f(d.status)}}function Ft(e,t){if(e&1&&(r(0,"td",23),u(1,Et,2,1,"div",24)(2,wt,2,1,"div",25),i()),e&2){let d=t.$implicit;l(),p("ngIf",d.status=="En attente"),l(),p("ngIf",d.status!="En attente")}}function It(e,t){e&1&&(r(0,"th",22),n(1,"Date"),i())}function Gt(e,t){if(e&1&&(r(0,"td",23),n(1),y(2,"date"),i()),e&2){let d=t.$implicit;l(),f(C(2,1,d.date,"dd/MM/yyyy"))}}function Ot(e,t){e&1&&(r(0,"th",28),n(1,"Action"),i())}function Nt(e,t){if(e&1){let d=q();r(0,"td",23)(1,"div",29)(2,"button",30),G("click",function(){let a=F(d).$implicit,o=b();return I(o.deleteItem(a.id))}),c(3,"i",31),i(),r(4,"button",30),G("click",function(){let a=F(d).$implicit,o=b();return I(o.newItem("edit",a.id))}),c(5,"i",32),i()()()}}function Tt(e,t){e&1&&c(0,"tr",33)}function Dt(e,t){e&1&&c(0,"tr",34)}var W=(()=>{let t=class t{constructor(m,a,o){this.ordersHttp=m,this.snackbar=a,this.router=o,this.displayedColumns=["fullname","phoneNumber","address","province","deliveryCost","total","date","status","actions"],this.data=[],this.resultsLength=0,this.isLoadingResults=!0,this.isRateLimitReached=!1,this.refresh=new ie}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),Y(this.sort.sortChange,this.paginator.page,this.refresh).pipe(ee({}),te(()=>(this.isLoadingResults=!0,this.ordersHttp.paginateOrders(this.sort.active,this.sort.direction,this.paginator.pageIndex,this.paginator.pageSize).pipe(Z(()=>K(null))))),X(m=>(this.isLoadingResults=!1,this.isRateLimitReached=m?.items?.length==0,m?.items===null?[]:(this.resultsLength=m?.totalCount,m?.items)))).subscribe(m=>this.data=m)}ngOnInit(){}newItem(m="creation",a=0){this.router.navigate([`/authenticated/orders/${m}/${a}`])}deleteItem(m){confirm("\xCAtes-vous s\xFBr de l'avoir fait?")&&this.ordersHttp.deleteOrder(m).subscribe({next:a=>{this.refresh.emit(),this.snackbar.open("La suppression a \xE9t\xE9 r\xE9ussie","\u2705",{duration:6e3})}})}};t.\u0275fac=function(a){return new(a||t)(v(B),v(j),v(A))},t.\u0275cmp=R({type:t,selectors:[["app-orders-grid"]],viewQuery:function(a,o){if(a&1&&(O(P,5),O($,5)),a&2){let s;N(s=T())&&(o.paginator=s.first),N(s=T())&&(o.sort=s.first)}},decls:40,vars:9,consts:[[1,"flex","flex-col","flex-1"],[1,"flex","flex-row","justify-start","items-center","px-6","py-4"],[1,"text-xl","font-medium","text-black"],[1,"flex","flex-col","m-6","shadow"],[1,"max-h-[calc(100vh-300px)]","overflow-auto"],["mat-table","","matSort","","matSortActive","id","matSortDisableClear","","matSortDirection","desc",3,"dataSource"],["matColumnDef","fullname"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","phoneNumber"],["matColumnDef","address"],["matColumnDef","province"],["matColumnDef","deliveryCost"],["matColumnDef","total"],["matColumnDef","quantityInStock"],["matColumnDef","status"],["matColumnDef","date"],["matColumnDef","actions"],["mat-header-cell","","class","!text-center w-20 ",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"pageSizeOptions","length","pageSize","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["class","px-2 py-[2px] bg-red-100 text-red-600 w-fit rounded",4,"ngIf"],["class","px-2 py-[2px] bg-blue-200 text-blue-600 w-fit rounded",4,"ngIf"],[1,"px-2","py-[2px]","bg-red-100","text-red-600","w-fit","rounded"],[1,"px-2","py-[2px]","bg-blue-200","text-blue-600","w-fit","rounded"],["mat-header-cell","",1,"!text-center","w-20"],[1,"flex","flex-row","items-center","space-x-2"],["mat-icon-button","",3,"click"],[1,"ri-delete-bin-6-line","text-red-600"],[1,"ri-pencil-line"],["mat-header-row",""],["mat-row",""]],template:function(a,o){a&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),n(3,"Commandes"),i()(),r(4,"div",3)(5,"div",4)(6,"table",5),x(7,6),u(8,dt,2,0,"th",7)(9,pt,2,1,"td",8),h(),x(10,9),u(11,st,2,0,"th",7)(12,ut,2,1,"td",8),h(),x(13,10),u(14,ct,2,0,"th",7)(15,ft,2,1,"td",8),h(),x(16,11),u(17,xt,2,0,"th",7)(18,ht,3,3,"td",8),h(),x(19,12),u(20,vt,2,0,"th",7)(21,_t,3,4,"td",8),h(),x(22,13),u(23,yt,2,0,"th",7)(24,gt,2,1,"td",8),h(),x(25,14),u(26,Ct,2,0,"th",7)(27,bt,2,1,"td",8),h(),x(28,15),u(29,St,2,0,"th",7)(30,Ft,3,2,"td",8),h(),x(31,16),u(32,It,2,0,"th",7)(33,Gt,3,4,"td",8),h(),x(34,17),u(35,Ot,2,0,"th",18)(36,Nt,6,0,"td",8),h(),u(37,Tt,1,0,"tr",19)(38,Dt,1,0,"tr",20),i()(),c(39,"mat-paginator",21),i()()),a&2&&(l(6),p("dataSource",o.data),l(31),p("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky",!0),l(),p("matRowDefColumns",o.displayedColumns),l(),p("pageSizeOptions",ne(8,mt))("length",o.resultsLength)("pageSize",20)("showFirstLastButtons",!0))},dependencies:[V,Te,De,Re,He,ke,Me,Ae,qe,Ve,je,Pe,P,$,H,le,Ge],styles:[`app-orders-grid{display:flex;flex:1}
`],encapsulation:2});let e=t;return e})();var Mt=[{path:"",redirectTo:"orders",pathMatch:"full"},{path:"",component:W},{path:":mode/:id",component:z}],ze=(()=>{let t=class t{};t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({imports:[L.forChild(Mt),L]});let e=t;return e})();var ui=(()=>{let t=class t{};t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({imports:[Qe,ze]});let e=t;return e})();export{ui as OrdersModule};
